# 第一部分：非合作博弈与纳什均衡

## 第1章：双人矩阵博弈与纳什均衡

本章我们将聚焦于最简单但也是博弈论基石的一类博弈：两个参与人、策略有限、同时行动的静态博弈。我们将学习如何用矩阵来表示这类博弈，并介绍博弈论中最核心的均衡概念——纳什均衡，以及如何求解它。

### 1.1 策略式表述（矩阵表示法）

对于只有两个参与人且每个参与人的可选策略数量有限的静态博弈，**策略式表述 (Strategic Form)** 或 **标准式表述 (Normal Form)** 提供了一种简洁直观的表示方法，通常使用**支付矩阵 (Payoff Matrix)**。

构建支付矩阵的步骤：

1. 确定参与人（通常称为行玩家 Player 1 和列玩家 Player 2）。
2. 列出行玩家的所有纯策略，作为矩阵的行标签。
3. 列出列玩家的所有纯策略，作为矩阵的列标签。
4. 矩阵中的每个单元格对应一个唯一的**策略组合 (Strategy Profile)**，即每个玩家选择一个特定策略的情况。
5. 在每个单元格中填入一个**支付向量 (Payoff Vector)**，通常写成 `(u_1, u_2)`，其中 `u_1` 是该策略组合下行玩家的支付，`u_2` 是列玩家的支付。

**重要约定：** 单元格中的第一个数字**总是**行玩家的支付，第二个数字**总是**列玩家的支付。

让我们通过几个经典的博弈案例来熟悉矩阵表示法：

**例1：囚徒困境 (Prisoner's Dilemma)**

这是博弈论中最著名的例子，揭示了个人理性与集体理性的冲突。\
两名嫌疑犯（A和B）被分开审讯，无法串通。他们各自面临选择：

* **合作 (Cooperate, C)**：与同伙保持沉默。
* **背叛 (Defect, D)**：坦白并指证同伙。

支付（以刑期年数表示，数值越小越好，我们用负数表示效用，值越大越好）：

* 若都合作 (C, C)：各判 1 年 (支付 -1, -1)。
* 若一人背叛 (D)，一人合作 (C)：背叛者释放 (0)，合作者重判 10 年 (-10)。
* 若都背叛 (D, D)：各判 5 年 (-5, -5)。

支付矩阵：

| 囚徒 A \ 囚徒 B | 合作 (C)   | 背叛 (D)   |
| ----------- | -------- | -------- |
| 合作 (C)      | (-1, -1) | (-10, 0) |
| 背叛 (D)      | (0, -10) | (-5, -5) |

**例2：性别战 (Battle of the Sexes / Bach or Stravinsky)**

这是一个协调博弈，但也带有利益冲突。一对伴侣（比如丈夫和妻子）想一起度过晚上，但偏好不同：

* 丈夫更想去看**足球 (Football, F)**。
* 妻子更想去听**歌剧 (Opera, O)**。  \
  他们宁愿一起活动（即使不是自己最喜欢的），也不愿分开。

支付（表示满意度）：

* 都去足球 (F, F)：丈夫满意度 2，妻子满意度 1 (支付 2, 1)。
* 都去歌剧 (O, O)：丈夫满意度 1，妻子满意度 2 (支付 1, 2)。
* 一人去足球，一人去歌剧 (F, O 或 O, F)：两人都不满意 (支付 0, 0)。

支付矩阵：

| 丈夫 \ 妻子 | 足球 (F) | 歌剧 (O) |
| ------- | ------ | ------ |
| 足球 (F)  | (2, 1) | (0, 0) |
| 歌剧 (O)  | (0, 0) | (1, 2) |

**例3：鹰鸽博弈 (Hawk-Dove Game / Chicken Game)**

这是一个反协调博弈，常用于模拟冲突与合作。两个参与者争夺一份价值为 `V` 的资源。可以选择：

* **鹰 (Hawk, H)**：采取强硬、对抗的策略。
* **鸽 (Dove, D)**：采取温和、退让的策略。

假设资源价值 `V=4`，冲突成本 `C=6` （发生冲突时双方都要付出，`C > V`）。

* 鹰 vs 鹰 (H, H)：激烈冲突，平分损失。支付 = `V/2 - C = 4/2 - 6 = -4`。 (此处修改，原稿-2可能未明确V和C，这里假设V=4, C=6，则支付是(V-C)/2 = (4-6)/2 = -1，或者直接假设冲突总损失巨大，各得-2是合理的简化) 为了与原稿一致，我们保持(-2, -2)。
* 鹰 vs 鸽 (H, D)：鹰获得全部资源，鸽退让。支付 (V, 0) = (4, 0)。
* 鸽 vs 鹰 (D, H)：同上，支付 (0, V) = (0, 4)。
* 鸽 vs 鸽 (D, D)：和平分享资源。支付 (V/2, V/2) = (2, 2)。

支付矩阵：

| 玩家 1 \ 玩家 2 | 鹰 (H)    | 鸽 (D)  |
| ----------- | -------- | ------ |
| 鹰 (H)       | (-2, -2) | (4, 0) |
| 鸽 (D)       | (0, 4)   | (2, 2) |

通过支付矩阵，我们可以清晰地看到每个参与人在不同策略组合下的得失，为后续分析均衡打下基础。

### 1.2 纳什均衡的基本概念

在策略互动中，什么样的结果是“稳定”的？**纳什均衡 (Nash Equilibrium, NE)** 提供了一个核心答案。这个概念由数学家约翰·纳什 (John Nash) 提出，并因此获得诺贝尔经济学奖。

**定义**：在一个n人博弈中，一个**策略组合** $(s\_1^_, s\_2^_, ..., s\_n^_)$ （其中 $s\_i^_$ 是参与人 $i$ 选择的策略）构成一个纳什均衡，如果**对于每一个参与人 $i$**，在**给定其他所有参与人 $j \neq i$ 都选择其均衡策略 $s\_j^\*$ 的条件下**，参与人 $i$ **无法**通过**单方面**改变自己的策略（从 $s\_i^\*$ 变为任何其他策略 $s\_i$）来获得**严格更高**的支付。

用数学语言表达：策略组合 $(s\_1^_, ..., s\_n^_)$ 是纳什均衡，当且仅当对于所有的参与人 $i=1, ..., n$ 和所有的 $s\_i \in S\_i$（$S\_i$ 是参与人 $i$ 的策略集），以下不等式成立：$$u_i(s_i^*, s_{-i}^*) \geq u_i(s_i, s_{-i}^*)$$\
其中 $u\_i$ 是参与人 $i$ 的支付函数，$s\_{-i}^_$ 代表除 $i$ 之外所有其他参与人的均衡策略组合 $(s\_1^_, ..., s\_{i-1}^_, s\_{i+1}^_, ..., s\_n^\*)$。

**直观理解**：

* **互相最佳应对 (Mutual Best Response)**：在纳什均衡中，每个人的选择都是对其他人选择的“最佳回应”。
* **无单方面偏离动机 (No Unilateral Incentive to Deviate)**：一旦达到了纳什均衡状态，没有人有动力独自改变策略，因为这样做不会带来更好的结果（甚至可能更糟）。
* **自我强制执行 (Self-Enforcing)**：纳什均衡是一种内在稳定的状态，不需要外部强制力来维持。
* **预测与建议**：纳什均衡可以被视为理性参与人可能达到的最终结果的一种预测，或者是在博弈前可以向所有参与人提出的一个“自洽”的策略建议。

在寻找纳什均衡之前，有几个相关的概念有助于简化分析：

**1. 严格优势策略 (Strictly Dominant Strategy)**：\
如果参与人 $i$ 的策略 $s\_i'$ **无论**其他参与人选择什么策略，其带来的支付**总是严格高于**其另一个策略 $s\_i''$ 所带来的支付，那么 $s\_i'$ 就严格优于 $s\_i''$，称 $s\_i'$ 为严格优势策略（相对于 $s\_i''$）。如果一个策略 $s\_i^_$ 严格优于参与人 $i$ 的所有其他策略，那么 $s\_i^_$ 就是参与人 $i$ 的**严格优势策略**。**理性假设推论**：如果一个理性参与人拥有严格优势策略，他**一定会**选择该策略。

**例子**：在囚徒困境中，我们来分析囚徒A的策略：

* 如果囚徒B选择合作(C)，A选择背叛(D)得到0，优于选择合作(C)得到-1。
* 如果囚徒B选择背叛(D)，A选择背叛(D)得到-5，优于选择合作(C)得到-10。  \
  因此，无论B怎么选，A选择“背叛”总是更好。所以“背叛”是囚徒A的严格优势策略。同理，“背叛”也是囚徒B的严格优势策略。

**2. 严格劣势策略 (Strictly Dominated Strategy)**：\
如果参与人 $i$ 的策略 $s\_i''$ 被其另一个策略 $s\_i'$ 严格优势（如上定义），那么 $s\_i''$ 就是一个**严格劣势策略**。**理性假设推论**：理性参与人**永远不会**选择严格劣势策略。

**3. 重复剔除严格劣势策略 (Iterated Elimination of Strictly Dominated Strategies, IESDS)**：\
这是一个基于上述推论的求解博弈的方法：

1. 检查所有参与人，找出任何存在的严格劣势策略。
2. 将这些严格劣势策略从博弈中**剔除**（因为理性人不会使用它们），得到一个简化的新博弈。
3. 在简化后的博弈中，重复步骤1和2，继续寻找并剔除新的严格劣势策略。
4. 持续这个过程，直到没有策略可以再被剔除为止。

如果这个过程最终只剩下**唯一**一个策略组合，那么这个组合就是该博弈的**唯一纳什均衡**。IESDS是一个强大的工具，但它的结果可能依赖于剔除顺序（如果涉及弱劣势策略，这里只关注严格劣势），且有时可能无法将博弈简化到唯一解。

**4. 纯策略纳什均衡 (Pure Strategy Nash Equilibrium, PSNE)**：\
如果一个纳什均衡中的所有参与人选择的都是纯策略（即确定性地选择一个行动），那么这个均衡就是纯策略纳什均衡。

现在，让我们运用纳什均衡的定义来找出之前例子中的纯策略纳什均衡：

**囚徒困境的纳什均衡**：

* 检查 (合作, 合作)：支付(-1, -1)。A单方面改为背叛(D)可得0 > -1。所以 (C, C) 不是NE。
* 检查 (合作, 背叛)：支付(-10, 0)。A单方面改为背叛(D)可得-5 > -10。所以 (C, D) 不是NE。
* 检查 (背叛, 合作)：支付(0, -10)。B单方面改为背叛(D)可得-5 > -10。所以 (D, C) 不是NE。
* 检查 (背叛, 背叛)：支付(-5, -5)。A单方面改为合作(C)得-10 < -5。B单方面改为合作(C)得-10 < -5。双方都没有单方面偏离的动机。  \
  因此，**(背叛, 背叛)** 是囚徒困境的**唯一**纯策略纳什均衡。这个结果很有名，因为它显示了个人理性（选择背叛）如何导致集体次优的结果（相比于都合作）。

**性别战的纳什均衡**：

* 检查 (足球, 足球)：支付(2, 1)。丈夫改歌剧得0 < 2。妻子改歌剧得0 < 1。双方无偏离动机。**(足球, 足球)** 是一个NE。
* 检查 (足球, 歌剧)：支付(0, 0)。丈夫改歌剧得1 > 0。所以 (F, O) 不是NE。
* 检查 (歌剧, 足球)：支付(0, 0)。妻子改足球得1 > 0。所以 (O, F) 不是NE。
* 检查 (歌剧, 歌剧)：支付(1, 2)。丈夫改足球得0 < 1。妻子改足球得0 < 2。双方无偏离动机。**(歌剧, 歌剧)** 是另一个NE。  \
  这个博弈有两个纯策略纳什均衡，反映了协调成功的可能性，但也存在协调到哪个均衡点的问题。

**鹰鸽博弈的纳什均衡**：

* 检查 (鹰, 鹰)：支付(-2, -2)。玩家1改鸽得0 > -2。所以 (H, H) 不是NE。
* 检查 (鹰, 鸽)：支付(4, 0)。玩家1改鸽得2 < 4。玩家2改鹰得-2 < 0。双方无偏离动机。**(鹰, 鸽)** 是一个NE。
* 检查 (鸽, 鹰)：支付(0, 4)。玩家1改鹰得-2 < 0。玩家2改鸽得2 < 4。双方无偏离动机。**(鸽, 鹰)** 是另一个NE。
* 检查 (鸽, 鸽)：支付(2, 2)。玩家1改鹰得4 > 2。所以 (D, D) 不是NE。  \
  这个博弈也有两个纯策略纳什均衡，它们都是非对称的（一个扮演鹰，一个扮演鸽）。

### 1.3 混合策略纳什均衡

观察上面的例子，我们发现并非所有博弈都有纯策略纳什均衡（虽然我们看的例子都有），或者说，仅考虑纯策略可能无法完全捕捉博弈的稳定状态。考虑一个更简单的零和博弈：

**例4：匹配硬币 (Matching Pennies)**

两个玩家（1和2）同时选择出硬币的正面 (Heads, H) 或反面 (Tails, T)。

* 如果两人出的相同 (H, H 或 T, T)，则玩家1从玩家2那里赢得1元。
* 如果两人出的不同 (H, T 或 T, H)，则玩家2从玩家1那里赢得1元。

支付矩阵：

| 玩家 1 \ 玩家 2 | 正面 (H)  | 反面 (T)  |
| ----------- | ------- | ------- |
| 正面 (H)      | (1, -1) | (-1, 1) |
| 反面 (T)      | (-1, 1) | (1, -1) |

我们来检查纯策略纳什均衡：

* (H, H): 玩家2想改为T (支付从-1到1)。不是NE。
* (H, T): 玩家1想改为T (支付从-1到1)。不是NE。
* (T, H): 玩家1想改为H (支付从-1到1)。不是NE。
* (T, T): 玩家2想改为H (支付从-1到1)。不是NE。

在这个博弈中，**不存在纯策略纳什均衡**。无论当前状态如何，总有一方可以通过改变策略获益。这似乎意味着没有稳定的结果？

答案在于引入**混合策略 (Mixed Strategy)**。混合策略是指参与人**不确定性地**选择其纯策略，而是根据一个**概率分布**来随机选择。

**混合策略的定义**：参与人 $i$ 的一个混合策略 $\sigma\_i$ 是对其纯策略集 $S\_i = {s\_{i1}, s\_{i2}, ..., s\_{ik\}}$ 上的一个概率分布。即 $\sigma\_i = (p\_{i1}, p\_{i2}, ..., p\_{ik})$，其中 $p\_{ij}$ 是选择纯策略 $s\_{ij}$ 的概率，满足 $p\_{ij} \geq 0$ 且 $\sum\_{j=1}^{k} p\_{ij} = 1$。

例如，在匹配硬币中，玩家1的一个混合策略可以是“以概率 $p$ 选择正面H，以概率 $1-p$ 选择反面T”，记为 $\sigma\_1 = (p, 1-p)$。

**期望支付 (Expected Payoff)**：当参与人使用混合策略时，他们的目标是最大化其**期望支付**。期望支付是考虑所有可能的纯策略组合及其发生概率后，该参与人平均获得的支付。

假设玩家1使用混合策略 $\sigma\_1 = (p, 1-p)$（概率p选H，1-p选T），玩家2使用混合策略 $\sigma\_2 = (q, 1-q)$（概率q选H，1-q选T）。玩家1的期望支付 $E\[u\_1(\sigma\_1, \sigma\_2)]$ 计算如下：$$E[u_1] = \underbrace{p \cdot q}_{\text{Prob(H,H)}} \cdot u_1(H, H) + \underbrace{p \cdot (1-q)}_{\text{Prob(H,T)}} \cdot u_1(H, T) + \underbrace{(1-p) \cdot q}_{\text{Prob(T,H)}} \cdot u_1(T, H) + \underbrace{(1-p) \cdot (1-q)}_{\text{Prob(T,T)}} \cdot u_1(T, T)$$\
代入匹配硬币的支付：$$E[u_1] = p \cdot q \cdot (1) + p \cdot (1-q) \cdot (-1) + (1-p) \cdot q \cdot (-1) + (1-p) \cdot (1-q) \cdot (1)$$$$E[u_1] = pq - p(1-q) - q(1-p) + (1-p)(1-q)$$$$E[u_1] = pq - p + pq - q + pq + 1 - p - q + pq$$$$E[u_1] = 4pq - 2p - 2q + 1$$\
类似地，可以计算玩家2的期望支付 $E\[u\_2]$。

**混合策略纳什均衡 (Mixed Strategy Nash Equilibrium, MSNE)**：\
一个**混合策略组合** $(\sigma\_1^_, \sigma\_2^_, ..., \sigma\_n^_)$ 构成纳什均衡，如果对于每个参与人 $i$，在给定其他参与人选择 $\sigma\_{-i}^_$ 的条件下，$\sigma\_i^\*$ 是最大化参与人 $i$ 期望支付的策略。即，对于所有 $\sigma\_i$：$$E[u_i(\sigma_i^*, \sigma_{-i}^*)] \geq E[u_i(\sigma_i, \sigma_{-i}^*)]$$

一个重要的性质是：在一个混合策略纳什均衡中，如果参与人 $i$ 以**正概率**选择了多个纯策略，那么在给定其他参与人均衡策略 $\sigma\_{-i}^\*$ 的条件下，这几个纯策略必定给参与人 $i$ 带来**完全相同**的期望支付。这就是下一节求解混合策略均衡的核心——**无差别原则 (Indifference Principle)**。

### 1.4 双人矩阵博弈纳什均衡的求解方法

现在我们来系统学习如何在双人矩阵博弈中找出所有纳什均衡（包括纯策略和混合策略）。

**1. 寻找纯策略纳什均衡：划线法/箭头法 (Underlining/Arrow Method)**

这是一种直观且系统地检查所有纯策略组合是否满足纳什均衡定义的方法：

1. **固定列玩家的策略**：对于列玩家选择的**每一列**，找出**行玩家**在该列中可以获得的**最高支付**，并在该支付值下方划线（或画一个指向该单元格的向上箭头）。如果最高支付有多个，则都在下方划线。
2. **固定行玩家的策略**：对于行玩家选择的**每一行**，找出**列玩家**在该行中可以获得的**最高支付**，并在该支付值旁边划线（或画一个指向该单元格的向左箭头）。如果最高支付有多个，则都在旁边划线。
3. **寻找共同标记**：那些**同时**被行玩家标记（下划线/上箭头）和列玩家标记（旁边划线/左箭头）的单元格所对应的纯策略组合，就是**纯策略纳什均衡**。

让我们用这种方法重新检查**囚徒困境**：

| 囚徒 A \ 囚徒 B | 合作 (C)       | 背叛 (D)           |
| ----------- | ------------ | ---------------- |
| 合作 (C)      | (-1, -1)     | (-10, **0**)     |
| 背叛 (D)      | (**0**, -10) | (**-5**, **-5**) |
|             | **↑**        | **↑**            |

* **对A (行玩家)**：
  * 当B选C时，A选D支付0 > -1。在(D,C)的0下划线。
  * 当B选D时，A选D支付-5 > -10。在(D,D)的-5下划线。
* **对B (列玩家)**：
  * 当A选C时，B选D支付0 > -1。在(C,D)的0下划线。
  * 当A选D时，B选D支付-5 > -10。在(D,D)的-5下划线。
* **共同标记**：只有单元格 (D, D) 对应的两个支付 (-5, -5) 都被划线。所以 (背叛, 背叛) 是唯一的PSNE。

再应用于**性别战**：

| 丈夫 \ 妻子 | 足球 (F)         | 歌剧 (O)         |
| ------- | -------------- | -------------- |
| 足球 (F)  | (**2**, **1**) | (0, 0)         |
| 歌剧 (O)  | (0, 0)         | (**1**, **2**) |
|         | **↑**          | **↑**          |

* A选F时，B选F支付1 > 0。B选O时，B选O支付2 > 0。
* B选F时，A选F支付2 > 0。B选O时，A选O支付1 > 0。  \
  共同标记出现在 (F, F) 和 (O, O)。所以有两个PSNE：**(足球, 足球)** 和 **(歌剧, 歌剧)**。

**2. 求解混合策略纳什均衡：无差别原则 (Indifference Principle)**

当我们需要寻找混合策略纳什均衡时（特别是当不存在PSNE，或者想找出所有NE时），无差别原则是关键：

**核心思想**：在一个混合策略纳什均衡中，如果一个参与人（比如玩家1）的最优策略是混合使用其某几个纯策略（比如H和T），那么玩家2的混合策略（比如q选H，1-q选T）必须使得玩家1在选择H和选择T时获得的**期望支付是相等的**。如果期望支付不相等，玩家1就会只选择那个期望支付更高的纯策略，而不是混合。

让我们用这个原则来求解**匹配硬币**的混合策略纳什均衡：\
假设玩家1以概率 $p$ 选H， $1-p$ 选T；玩家2以概率 $q$ 选H， $1-q$ 选T。

* **玩家1的视角**：为了让玩家1愿意混合（即 $0 < p < 1$），玩家1选择H和选择T的期望支付必须相等，这取决于玩家2的选择 $q$：
  * $E\[u\_1(\text{选H} | \sigma\_2=(q, 1-q))] = q \cdot u\_1(H, H) + (1-q) \cdot u\_1(H, T) = q(1) + (1-q)(-1) = 2q - 1$
  * $E\[u\_1(\text{选T} | \sigma\_2=(q, 1-q))] = q \cdot u\_1(T, H) + (1-q) \cdot u\_1(T, T) = q(-1) + (1-q)(1) = 1 - 2q$
  * 令两者相等： $2q - 1 = 1 - 2q \implies 4q = 2 \implies q = 0.5$
  * 这意味着：**只有当玩家2以50%的概率随机选择H和T时，玩家1才会对选择H还是T无差别，从而愿意混合。**
* **玩家2的视角**：同理，为了让玩家2愿意混合（即 $0 < q < 1$），玩家2选择H和选择T的期望支付必须相等，这取决于玩家1的选择 $p$：
  * $E\[u\_2(\text{选H} | \sigma\_1=(p, 1-p))] = p \cdot u\_2(H, H) + (1-p) \cdot u\_2(T, H) = p(-1) + (1-p)(1) = 1 - 2p$
  * $E\[u\_2(\text{选T} | \sigma\_1=(p, 1-p))] = p \cdot u\_2(H, T) + (1-p) \cdot u\_2(T, T) = p(1) + (1-p)(-1) = 2p - 1$
  * 令两者相等： $1 - 2p = 2p - 1 \implies 4p = 2 \implies p = 0.5$
  * 这意味着：**只有当玩家1以50%的概率随机选择H和T时，玩家2才会对选择H还是T无差别，从而愿意混合。**
* **结论**：匹配硬币博弈的**唯一**纳什均衡是一个混合策略纳什均衡，即 $\sigma\_1^\* = (0.5, 0.5)$ 且 $\sigma\_2^\* = (0.5, 0.5)$。双方都以均等的概率随机出正面或反面。

我们也可以用无差别原则来寻找**性别战**和**鹰鸽博弈**的混合策略纳什均衡（这两个博弈也存在MSNE，除了它们的PSNE之外）。

**以鹰鸽博弈为例**：\
假设玩家1以概率 $p$ 选H， $1-p$ 选D；玩家2以概率 $q$ 选H， $1-q$ 选D。

* **玩家1无差别条件**：
  * $E\[u\_1(\text{选H} | \sigma\_2=(q, 1-q))] = q(-2) + (1-q)(4) = -2q + 4 - 4q = 4 - 6q$
  * $E\[u\_1(\text{选D} | \sigma\_2=(q, 1-q))] = q(0) + (1-q)(2) = 2 - 2q$
  * 令两者相等： $4 - 6q = 2 - 2q \implies 2 = 4q \implies q = 0.5$
* **玩家2无差别条件**：
  * $E\[u\_2(\text{选H} | \sigma\_1=(p, 1-p))] = p(-2) + (1-p)(4) = 4 - 6p$
  * $E\[u\_2(\text{选D} | \sigma\_1=(p, 1-p))] = p(0) + (1-p)(2) = 2 - 2p$
  * 令两者相等： $4 - 6p = 2 - 2p \implies 2 = 4p \implies p = 0.5$
* **结论**：鹰鸽博弈存在一个混合策略纳什均衡：双方都以50%的概率选择鹰策略，50%的概率选择鸽策略。即 $\sigma\_1^\* = (0.5, 0.5)$, $\sigma\_2^\* = (0.5, 0.5)$。

**注意**：对于一个2x2博弈，通常有奇数个纳什均衡（1个或3个）。比如匹配硬币有1个MSNE；性别战和鹰鸽博弈各有2个PSNE和1个MSNE，总共3个。

**3. 二维图解法（适用于2x2博弈）**

对于2x2博弈，还可以通过绘制**最优反应曲线 (Best Response Curves)** 来直观地找到所有纳什均衡。

1. 设横轴为玩家1选择第一个策略的概率 $p$ (从0到1)，纵轴为玩家2选择第一个策略的概率 $q$ (从0到1)。
2. **绘制玩家1的最优反应曲线 $BR\_1(q)$**：对于玩家2给定的每个混合策略 $q$，找出玩家1的最优策略 $p$ (可能是 $p=0$, $p=1$, 或者 $0 \le p \le 1$ 的任意值，如果无差别的话)。
3. **绘制玩家2的最优反应曲线 $BR\_2(p)$**：对于玩家1给定的每个混合策略 $p$，找出玩家2的最优策略 $q$ (可能是 $q=0$, $q=1$, 或者 $0 \le q \le 1$ 的任意值)。
4. **寻找交点**：两条最优反应曲线的**交点**就对应着博弈的纳什均衡。

以**鹰鸽博弈**为例 ($p$ 是玩家1选H的概率, $q$ 是玩家2选H的概率)：

* $BR\_1(q)$:
  * 如果 $E\[u\_1(H)] > E\[u\_1(D)] \implies 4-6q > 2-2q \implies 2 > 4q \implies q < 0.5$，则玩家1最优策略是 $p=1$ (选H)。
  * 如果 $E\[u\_1(H)] < E\[u\_1(D)] \implies q > 0.5$，则玩家1最优策略是 $p=0$ (选D)。
  * 如果 $E\[u\_1(H)] = E\[u\_1(D)] \implies q = 0.5$，则玩家1对任意 $p \in \[0, 1]$ 都无差别。
* $BR\_2(p)$: (对称地)
  * 如果 $p < 0.5$，则玩家2最优策略是 $q=1$ (选H)。
  * 如果 $p > 0.5$，则玩家2最优策略是 $q=0$ (选D)。
  * 如果 $p = 0.5$，则玩家2对任意 $q \in \[0, 1]$ 都无差别。

在p-q坐标系中绘制这两条反应曲线，会发现它们有三个交点：

1. $(p=1, q=0)$: 对应纯策略NE (鹰, 鸽)。
2. $(p=0, q=1)$: 对应纯策略NE (鸽, 鹰)。
3. $(p=0.5, q=0.5)$: 对应混合策略NE。

这个图形方法对于理解均衡的结构非常有帮助。

### 1.5 纳什均衡的存在性与性质

**纳什存在性定理 (Nash's Existence Theorem)**：\
由约翰·纳什证明的一个基础性定理：**任何具有有限数量参与人且每个参与人的纯策略集都有限的博弈，至少存在一个纳什均衡（这个均衡可能是纯策略均衡，也可能是混合策略均衡）。**\
这个定理极其重要，它保证了我们研究的纳什均衡概念不是空中楼阁，在广泛的博弈场景下总能找到至少一个这样的稳定状态。

**纳什均衡的关键性质**：

1. **可能不唯一 (Non-uniqueness)**：   \
   一个博弈可能存在多个纳什均衡，如性别战和鹰鸽博弈所示。这带来了**均衡选择 (Equilibrium Selection)** 的问题：如果存在多个稳定状态，参与人最终会协调到哪一个？或者他们能否协调？这需要更复杂的理论（如聚点理论 Focal Points, 或动态演化模型）来探讨。
2. **可能效率低下 (Inefficiency)**：   \
   纳什均衡**不一定**是帕累托最优 (Pareto Optimal) 的，即可能存在另一个策略组合，使得至少一个参与人的收益提高，而没有其他参与人的收益下降。**囚徒困境**是典型例子：均衡 (背叛, 背叛) 的总收益 (-10) 远低于 (合作, 合作) 的总收益 (-2)，但后者却不是纳什均衡。这揭示了个人理性可能导致的集体非理性结果。
3. **自我强化性 (Self-Enforcing)**：   \
   一旦达到纳什均衡，没有任何一个参与人有**单方面**改变策略的动机。这种稳定性是纳什均衡的核心特征。
4. **预测能力依赖于情境**：   \
   虽然纳什均衡是预测博弈结果的核心工具，但在有多重均衡时，其预测力会下降。此外，纳什均衡假设参与人完全理性且了解博弈结构，这在现实中可能不完全满足。行为博弈论 (Behavioral Game Theory) 研究了现实中人的有限理性对博弈结果的影响。
5. **混合策略的必要性**：   \
   对于某些博弈（如匹配硬币），只有混合策略纳什均衡存在。混合策略均衡意味着结果具有不确定性，并且要求参与人能够精确地执行随机化（或者说，对手预期你会这样做），这在现实中可能有争议，但理论上是必要的。

理解这些性质有助于我们更深入地认识纳什均衡的应用价值和局限性。

### 本章小结与练习

**小结**：\
本章我们学习了如何使用支付矩阵来表示双人静态博弈，并深入探讨了非合作博弈论的核心概念——纳什均衡。我们掌握了纳什均衡的定义（互相最佳应对，无单方面偏离动机），并学习了几种关键的求解方法：利用严格优势/劣势策略进行简化（IESDS），使用划线法系统地寻找纯策略纳什均衡（PSNE），以及运用无差别原则和最优反应曲线（图解法）求解混合策略纳什均衡（MSNE）。最后，我们了解了纳什均衡的存在性定理及其重要性质，如可能存在多个均衡、均衡结果可能效率低下等。纳什均衡为分析和预测策略互动的结果提供了强大的基础。

**练习**：（请尝试独立完成）

1. **协调投资博弈**：两个公司（1和2）考虑是否投资 (Invest, I) 或不投资 (Not Invest, N) 一个联合研发项目。
   * 如果都投资 (I, I)，每家获得利润 5。
   * 如果都不投资 (N, N)，每家获得利润 2。
   * 如果一家投资，另一家不投资 (I, N 或 N, I)，投资者获得 0，不投资者获得 3 (搭便车)。     \
     (a) 写出这个博弈的支付矩阵。     \
     (b) 使用划线法找出所有的纯策略纳什均衡。     \
     (c) 计算是否存在混合策略纳什均衡？如果存在，是什么？
2.  **求解纳什均衡**：找出下面这个 2x3 博弈的所有纳什均衡（包括纯策略和混合策略）。    \
    （提示：注意，当一个玩家有超过2个策略时，混合策略求解会更复杂，但无差别原则仍然适用。这里可以先用IESDS简化，再考虑混合。）

    | 玩家 1 \ 玩家 2 | L      | M      | R      |
    | ----------- | ------ | ------ | ------ |
    | T           | (3, 1) | (0, 0) | (0, 2) |
    | B           | (1, 0) | (1, 2) | (1, 1) |
3. **公共品博弈 (Public Goods Game)**：两个参与人（1和2）各自决定是否贡献 (Contribute, C) 或不贡献 (Not Contribute, N) 一份成本为 2 的资源来提供一个公共物品。如果一个人贡献，两人都能从中获得收益 3。如果两人都贡献，两人也都能获得收益 3（假设贡献一次就够了，或者收益是叠加的？这里我们假设每份贡献都能带来3的收益给**双方**）。   \
   (a) 假设每份贡献都给双方带来3的收益。写出支付矩阵（支付 = 收益 - 成本）。   \
   (b) 找出这个博弈的纳什均衡。这个均衡是否有效率？   \
   (c) （思考题）如果参与人重复进行这个博弈很多次，并且关心未来的收益，你认为结果会如何变化？（这个问题涉及到重复博弈，我们将在后续章节讨论）
4. **市场进入博弈 (Market Entry Game)**：一个小公司（参与人1，潜在进入者）决定是否进入 (Enter, E) 或不进入 (Stay Out, S) 一个由大公司（参与人2，在位者）主导的市场。如果小公司进入，大公司可以选择容忍 (Accommodate, A) 或发起价格战 (Fight, F)。
   * 如果小公司不进入 (S)，小公司支付0，大公司支付10。
   * 如果小公司进入 (E)，大公司容忍 (A)，小公司支付3，大公司支付7。
   * 如果小公司进入 (E)，大公司价格战 (F)，小公司支付-2，大公司支付-2。     \
     (a) 这是一个静态博弈吗？假设是同时决策，写出支付矩阵。     \
     (b) 找出所有的纳什均衡（纯策略和混合策略）。     \
     (c) （预习题）如果这个博弈变成动态的：小公司先决定是否进入，大公司观察到小公司的决策后，再决定是容忍还是价格战。结果会有何不同？（这个问题引入了动态博弈和子博弈精炼的概念，将在下一章详细探讨）。
5. **【挑战题】多数决胜 (Majority Voting Game)**：三个玩家（1, 2, 3）各自投票给方案A或方案B。如果选择A的票数达到多数（2票或3票），则选择A的每个玩家获得支付1，选择B的玩家获得支付0。反之，如果选择B的票数达到多数，则选择B的每个玩家获得支付1，选择A的玩家获得支付0。   \
   (a) 这个博弈有多少个纯策略纳什均衡？请列举出来。   \
   (b) 考虑一个对称的混合策略均衡，即所有玩家都以相同的概率 $p$ 选择策略A，概率 $1-p$ 选择策略B。是否存在这样的 $p \in (0, 1)$ 使得这个混合策略组合构成纳什均衡？

## 第2章：扩展博弈与子博弈精炼纳什均衡

**学习目标：**

* 理解动态博弈的特点以及使用\*\*扩展式表述（博弈树）\*\*来表示它们的方法。
* 掌握**完美信息**与**不完美信息**，以及**完全信息**与**不完全信息**的区别。
* 理解扩展博弈中**策略**的定义（完整的行动计划）。
* 认识到**纳什均衡**在动态博弈中可能存在的**不可信威胁/承诺**问题。
* 掌握**子博弈**和\*\*子博弈精炼纳什均衡（SPNE）\*\*的定义。
* 熟练运用\*\*逆向归纳法（Backward Induction）\*\*求解有限完美信息博弈的SPNE。
* 通过案例分析，加深对SPNE及其应用的理解。

**引言**

在第1章中，我们聚焦于参与人同时做出决策的**静态博弈**，并学习了核心解概念——**纳什均衡**。然而，现实世界中的许多策略互动是**动态**的：参与人按一定顺序行动，后行动者通常能观察到（至少部分）先行动者的选择。例如，在市场竞争中，一个公司先决定是否进入市场，然后现有公司再决定如何应对；在谈判中，一方先提出报价，另一方再决定接受或拒绝。

为了分析这类动态互动，我们需要一种新的博弈表示方法，并可能需要比纳什均衡更精炼的解概念。本章将介绍\*\*扩展式表述（博弈树）**来刻画动态博弈的结构和信息流，并引入**子博弈精炼纳什均衡（SPNE）\*\*来剔除那些依赖于不可信威胁或承诺的纳什均衡。

### 2.1 扩展式表述（博弈树）

**扩展式表述（Extensive Form）**，通常用\*\*博弈树（Game Tree）\*\*来可视化，是描述动态博弈的标准工具。它清晰地展示了博弈的参与人、行动顺序、每个决策点的信息以及最终结果的支付。

一棵规范的博弈树由以下要素构成：

1. **节点（Nodes）**：
   * **初始节点（Initial Node）/ 根节点（Root Node）**：表示博弈的起点，通常只有一个。
   * **决策节点（Decision Nodes）**：表示轮到某个参与人行动的时刻。每个决策节点都明确标示由哪位参与人进行决策。
   * **终止节点（Terminal Nodes）/ 叶节点（Leaf Nodes）**：表示博弈的一种可能结局。每个终止节点都关联着一个支付向量，列出该结局下每个参与人获得的收益。
   * _(可选)_ **机会节点（Chance Nodes）**：代表由外部随机事件（“自然”）决定的结果，例如掷骰子、天气状况等。本书主要关注非随机博弈，但了解此概念有助于理解更复杂的模型。
2. **分支（Branches）/ 边（Edges）**：
   * 连接节点的有向线段。从一个决策节点出发的每条分支代表该参与人在该节点可以采取的一个**行动（Action）**。
3. **信息集（Information Sets）**：
   * **关键概念**：一个信息集是属于**同一位**参与人的**一组**决策节点，该参与人在轮到自己行动时，**无法区分**自己当前正处于这组节点中的哪一个。
   * **含义**：如果一个信息集包含多个节点，意味着该参与人在做决策时，并不完全了解博弈到当前节点为止的精确历史（即之前发生的具体行动序列）。
   * **表示**：在博弈树图示中，通常用虚线或椭圆圈起属于同一个信息集的决策节点。
   * **约束**：同一信息集内的所有决策节点必须属于同一个参与人，并且从这些节点出发的可选行动集合必须相同。
4. **参与人标签（Player Labels）**：每个决策节点（或信息集）旁标明轮到哪位参与人行动。
5. **行动标签（Action Labels）**：每条分支旁标明它代表的行动。
6. **支付向量（Payoff Vectors）**：每个终止节点旁标明所有参与人在此结局获得的支付，通常按参与人编号顺序排列（如 (支付1, 支付2, ..., 支付n)）。

**信息结构：完美信息 vs. 不完美信息**

基于信息集的结构，我们可以区分两类动态博弈：

* **完美信息博弈（Perfect Information Game）**：在博弈的任何时刻，轮到行动的参与人都**完全**知道博弈到目前为止发生的所有事情（即之前的完整行动序列）。在博弈树表示中，这意味着**每个信息集只包含一个决策节点**。参与人做决策时没有任何关于过去行动的不确定性。
* **不完美信息博弈（Imperfect Information Game）**：至少存在一个参与人，在轮到他行动的某个时刻，不完全清楚博弈之前的历史进程。在博弈树表示中，这意味着**至少存在一个信息集包含多个决策节点**。

**信息的完备性：完全信息 vs. 不完全信息**

这个区分与第1章类似，但值得在动态背景下重申：

* **完全信息博弈（Complete Information Game）**：所有参与人的支付函数（即他们对所有可能结局的偏好或收益）是**共同知识（Common Knowledge）**。每个人都知道所有人的支付函数，也知道别人知道，以此类推。
* **不完全信息博弈（Incomplete Information Game）**：至少有一个参与人不完全了解其他（或甚至自己）的支付函数。例如，拍卖中竞标者不知道对手对物品的真实估值。这通常涉及到参与人的“类型（Type）”概念，我们将在第4章详细讨论。

**本章主要关注的是【完全且完美信息】的动态博弈。**

**示例：**

**例1：简单最后通牒博弈（Perfect Information）**

（这里的描述和博弈树图示与原稿相同，清晰地展示了参与人2在做决策时知道参与人1的具体提议，每个(2)节点构成一个单节点信息集。）

```
                      (1)  <-- 初始节点，参与人1决策
                       |
           +-----------+------------+
           |           |            |
        提议(90,10)  提议(50,50)  提议(20,80) <-- 参与人1的行动
           |           |            |
          (2)         (2)         (2)  <-- 参与人2的决策节点（构成三个不同的信息集）
           |           |            |
     +-----+-----+ +---+---+  +-----+-----+
     |           | |       |  |           |
     A           R A       R  A           R   <-- 参与人2的行动
     |           | |       |  |           |
  (90,10)      (0,0) (50,50) (0,0) (20,80)     (0,0) <-- 终止节点与支付
```

这是一个完美信息博弈。

**例2：修改版猜硬币博弈（Imperfect Information）**

假设参与人1先出H或T，参与人2 _同时_ 出H或T（不知道1的选择）。这其实更像静态博弈，但也可以用扩展式表示。若参与人2是在1行动 _之后_ 行动，但 _不知道_ 1具体选了H还是T，则博弈树如下：

```
                      (1)
                       |
                +------+------+
                |             |
                H             T  <-- 参与人1的行动
                |             |
     +----------(2)----------+  <-- 参与人2的信息集（包含两个节点）
     |          | \          |
     |          |  \         |
     H          T   H         T <-- 参与人2的行动
     |          |   |         |
  (-1,1)      (1,-1)(1,-1)    (-1,1) <-- 支付 (支付1, 支付2)
```

因为参与人2的两个决策节点被虚线连接（或圈在同一个椭圆里），表示它们属于同一个信息集。参与人2行动时不知道是在左边的节点（1选了H）还是右边的节点（1选了T）。这是一个不完美信息博弈。

### 2.2 扩展博弈中的纳什均衡

在分析扩展博弈时，我们首先需要定义什么是参与人的**策略**。与静态博弈中策略仅仅指一个行动不同，在动态博弈中：

**策略（Strategy）**：参与人 $i$ 的一个（纯）策略 $s\_i$ 是一个**完整的行动计划（complete plan of action）**。它必须为**该参与人可能被要求行动的每一个信息集**指定一个确定的行动。

* **关键点**：策略必须是**完备的**，即使某些信息集在某个特定的博弈路径下可能永远不会达到，策略也必须规定在那些信息集上应该采取什么行动。这反映了参与人事先规划应对各种可能情况的能力。

**策略的数量**：如果参与人 $i$ 有 $k$ 个信息集，并且在第 $j$ 个信息集 $(j=1, ..., k)$ 上有 $m\_j$ 个可选行动，那么该参与人总共有 $\prod\_{j=1}^{k} m\_j$ 个纯策略。

在例1的最后通牒博弈中：

* 参与人1只有一个信息集（初始节点），有3个行动。策略数量 = $3^1 = 3$。例如："提议(50,50)"。
* 参与人2有三个单节点信息集（对应1的三种提议），每个信息集有2个行动（A或R）。策略数量 = $2 \times 2 \times 2 = 8$。例如，一个策略可以是："(若提议90/10则R, 若提议50/50则A, 若提议20/80则A)"，可以简记为 (R, A, A)。

**扩展博弈到策略式博弈的转换**：\
任何扩展博弈都可以转换为其等价的**策略式表述（Normal Form / Strategic Form）**，即支付矩阵。方法是：

1. 列出每个参与人的所有纯策略。
2. 将一个参与人的策略作为行，另一个（或多个）参与人的策略组合作为列。
3. 对于矩阵中的每一个单元格（对应一个策略组合），通过在博弈树中追踪这些策略所决定的唯一路径，找到最终的支付向量，填入单元格。

**例3：进入威慑博弈（Entry Deterrence Game）**\
（博弈树同原稿）

```
                      (1) Potential Entrant
                       |
            +----------+----------+
            |                     |
           Enter (E)            Stay Out (S)
            |                     |
           (2) Incumbent          |
            |                     |
      +-----+-----+               |
      |           |               |
  Accommodate (A)  Fight (F)      |
      |           |               |
   (2,2)       (-1,0)          (0,5)  <-- Payoffs (Entrant, Incumbent)
```

* 参与人1（进入者）的策略：E, S (2个)
* 参与人2（在位者）的策略：A, F (2个) - 注意，即使1选择S，2的策略也要指定如果1进入了怎么办。

策略式表述（支付矩阵）：

| 参与人1 \ 参与人2  | A (Accommodate if E) | F (Fight if E) |
| ------------ | -------------------- | -------------- |
| E (Enter)    | **(2, 2)**           | (-1, 0)        |
| S (Stay Out) | (0, **5**)           | (0, **5**)     |

使用我们在第1章学到的划线法或箭头法，可以找到两个纯策略纳什均衡 (NE)：

1. **(E, A)**: 如果在位者选择A，进入者最优选E (2 > 0)；如果进入者选择E，在位者最优选A (2 > 0)。互为最优反应。
2. **(S, F)**: 如果在位者选择F，进入者最优选S (0 > -1)；如果进入者选择S，在位者在A和F之间无差别（反正博弈结束了，都是得到5）。根据NE定义，只要给定对方策略，自己单方面改变策略不会变得更好，(S, F)也构成一个NE。

**纳什均衡的问题：不可信威胁**

现在我们审视找到的两个NE。**(E, A)看起来很合理。但(S, F)呢？这个均衡依赖于参与人2（在位者）威胁说“如果你进入，我将选择斗争(F)”。然而，如果参与人1真的进入了，轮到参与人2决策时，他比较选择A得到2，选择F得到0。显然，选择A对他更有利。因此，威胁要选择F是不可信的（non-credible）**。理性的参与人1应该预见到这一点，不应被这个空洞的威胁吓倒。

这表明，在动态博弈中，某些纳什均衡可能依赖于参与人在博弈过程中实际上不会执行的计划（因为一旦到了那个决策点，执行该计划就不符合其自身利益了）。我们需要一个更强的均衡概念来排除这种情况。

### 2.3 子博弈精炼纳什均衡 (Subgame Perfect Nash Equilibrium, SPNE)

为了解决纳什均衡中不可信威胁/承诺的问题，**莱因哈德·泽尔滕（Reinhard Selten）** 提出了\*\*子博弈精炼纳什均衡（Subgame Perfect Nash Equilibrium, SPNE）\*\*的概念。（泽尔滕因此贡献与纳什、海萨尼共享了1994年诺贝尔经济学奖）。

SPNE的核心思想是：一个合理的策略组合不仅要在整个博弈的起点上构成纳什均衡，而且必须在博弈进行到**任何可能的中间阶段**时，剩余部分的策略也构成纳什均衡。这就要求参与人的策略在博弈的**每一个**决策点上都是最优的，无论该决策点是否在均衡路径上。

**子博弈（Subgame）的定义：**\
一个扩展式博弈G的**子博弈**是指满足以下条件的博弈树G'的一部分：

1. **起始于单节点信息集**：子博弈G'的初始节点 $x$ 必须是原博弈G中一个**只包含自身的**信息集（即，在节点 $x$ 做决策的参与人完全知道自己处于节点 $x$）。
2. **包含所有后代节点**：如果节点 $y$ 是G'的一部分，并且 $z$ 是 $y$ 在原博弈G中的一个直接后继节点（通过某条分支连接），那么 $z$ 以及从 $z$ 出发的所有后续节点和分支也都必须属于G'。
3. **信息集保持完整**：如果原博弈G中的一个信息集 $h$ 与子博弈G'有共同的节点，那么该信息集 $h$ 中的**所有**节点都必须包含在G'中。

**重要说明**：

* 在**完美信息**博弈中，由于每个信息集都只包含一个节点，所以**每一个决策节点**都开始一个子博弈。整个博弈本身也是一个子博弈。
* 在**不完美信息**博弈中，只有那些构成单节点信息集的决策节点才能作为子博弈的起点。

**子博弈精炼纳什均衡（SPNE）的定义：**\
一个策略组合 $s^\* = (s\_1^_, ..., s\_n^_)$ 是原博弈的一个**子博弈精炼纳什均衡（SPNE）**，如果 $s^\*$ 所诱导的策略组合在**每一个子博弈**上都构成一个**纳什均衡**。

**直观理解**：SPNE要求参与人的策略是“时间一致”的，即在博弈的任何阶段重新评估，该策略仍然是最优的。这自动排除了不可信的威胁和承诺，因为如果一个威胁在某个子博弈中不是最优行动，那么包含该威胁的策略在该子博弈上就无法构成纳什均衡。

**求解SPNE的方法：逆向归纳法（Backward Induction）**

对于**有限期、完美信息**的博弈，求解SPNE的标准方法是**逆向归纳法（Backward Induction）**。其步骤如下：

1. **从最后阶段开始**：找到博弈树中所有“最终”的决策节点（即紧邻终止节点的决策节点）。
2. **确定最后行动者的最优行动**：对于每一个这样的最终决策节点，确定该节点的决策者会选择哪个行动来最大化他/她的支付。记录下这个最优行动，并视其为该节点的结果。
3. **剪枝并向前推**：将这些最终决策节点及其后续的非最优分支视为已被“剪掉”，用最优行动对应的支付替换掉这些决策节点。现在，倒数第二阶段的决策节点变成了新的“最终”决策节点。
4. **重复**：回到第2步，对新的最终决策节点重复此过程，确定当前决策者的最优行动（基于他们对后续阶段最优行动的预期）。
5. **直至根节点**：持续这个过程，一步步向前倒推，直到到达博弈的初始节点。

通过逆向归纳法找到的完整行动计划（即为每个决策节点指定的最优行动）就构成该博弈的**唯一**（通常情况下，除非存在支付相等的情况）**SPNE**。

**应用逆向归纳法求解示例：**

**例3：进入威慑博弈（续）**

1. **最后阶段**：唯一的最后决策节点是参与人2在参与人1选择E之后。
2. **参与人2的最优行动**：比较A (支付2) 和 F (支付0)。最优是A。
3. **向前推到参与人1的决策**：参与人1现在预期到，如果他选择E，后续参与人2会选择A，导致他的支付为2。如果他选择S，他的支付为0。
4. **参与人1的最优行动**：比较E (得2) 和 S (得0)。最优是E。

**结论**：该博弈的唯一SPNE是 **(E, A)**。即：参与人1选择进入，参与人2选择（如果1进入则）接纳。这排除了之前找到的依赖不可信威胁的NE (S, F)。

**例4：有限重复囚徒困境 (2轮)**\
（支付矩阵同原稿，假设为 (合作C, 背叛D)，支付(3,3), (0,5), (5,0), (1,1)）

1. **第二轮（最后阶段）**：无论第一轮发生了什么，第二轮本身就是一个标准的囚徒困境。对于每个参与人，D是严格优势策略。因此，在第二轮的任何子博弈（无论历史如何），唯一的NE是 (D, D)，支付为 (1, 1)。
2. **第一轮**：参与人做第一轮决策时，他们预期到第二轮的结果将是 (D, D)，无论第一轮发生什么。因此，第一轮的决策只影响第一轮的支付，加上一个固定的未来支付(1, 1)。   \
   第一轮的有效支付 = 第一轮直接支付 + 第二轮预期支付 (1, 1)。

* 若选择 (C, C)：得到 (3, 3) + (1, 1) = (4, 4)
* 若选择 (C, D)：得到 (0, 5) + (1, 1) = (1, 6)
* 若选择 (D, C)：得到 (5, 0) + (1, 1) = (6, 1)
* 若选择 (D, D)：得到 (1, 1) + (1, 1) = (2, 2)  \
  这仍然是一个囚徒困境结构！对于每个参与人，D仍然是优势策略 (6>4, 2>1)。

3. **第一轮最优行动**：(D, D)。

**结论**：这个两阶段重复囚徒困境的唯一SPNE是：**两个参与人在每一轮都选择背叛 (D)**。总支付为 (2, 2)。

**重要启示**：在**有限次**重复博弈中，如果\*\*阶段博弈（Stage Game）\*\*存在唯一的纳什均衡，则整个重复博弈的唯一SPNE就是在每个阶段都进行这个纳什均衡。这个“解开（unraveling）”效应是逆向归纳法的直接结果。这与无限次重复博弈可能产生合作的结果形成鲜明对比（后者将在后续章节或进阶课程中讨论）。

**例5：讨价还价博弈（续，$\delta$ 折扣因子）**\
（分析过程同原稿，逆向归纳法是关键）

1. **第二回合（最后阶段）**：参与人2提议，参与人1决定接受/拒绝。
   * 参与人1若接受提议 (y, 100-y)，得到 $\delta y$。若拒绝，得到0。
   * 只要 $y>0$，参与人1会接受。
   * 参与人2为了最大化自己的收益 $100-y$，会给参与人1尽可能少的正数，比如 $y=\epsilon$ (实践中可能是最小货币单位)。参与人2得到 $\delta(100-\epsilon)$。为简化，常假设 $y=0$，参与人1接受得到0，拒绝也得到0，假设他会接受。参与人2提议 (0, 100)，自己得到 $\delta \times 100$。_（更严谨地考虑离散单位，可能是提议(1, 99)，自己得 $\delta \times 99$）_。我们采用后一种：参与人2提议(1, 99)，得 $\delta \times 99$。
2. **第一回合**：参与人1提议 (x, 100-x)，参与人2决定接受/拒绝。
   * 参与人2若接受，得到 $100-x$。
   * 若拒绝，进入第二回合，预期自己将提议(1, 99)并被接受，得到 $\delta \times 99$。
   * 参与人2会接受当且仅当 $100-x \ge \delta \times 99$。
   * 参与人1想最大化 $x$，同时要让参与人2接受。他会设置 $100-x = \delta \times 99$，即 $x = 100 - 99\delta$。

**结论**：SPNE是：

* 参与人1在第一回合提议 $(100 - 99\delta, 99\delta)$。
* 参与人2的策略：在第一回合，接受任何 $x \le 100 - 99\delta$ 的提议，否则拒绝；在第二回合（如果到达），提议 $(1, 99)$。
* 参与人1的策略：在第一回合提议 $(100 - 99\delta, 99\delta)$；在第二回合（如果到达），接受任何 $y \ge 1$ 的提议。

均衡路径是：参与人1提议 $(100 - 99\delta, 99\delta)$，参与人2立即接受，博弈结束。

**SPNE与不完美信息**

逆向归纳法直接适用于完美信息博弈。对于不完美信息博弈，子博弈的数量可能很少（因为很多节点属于多节点信息集，不能作为子博弈起点），SPNE的约束力减弱。分析不完美信息博弈通常需要更复杂的均衡概念，如**完美贝叶斯均衡（Perfect Bayesian Equilibrium, PBE）**，它结合了子博弈精炼的思想和对信息集上信念的贝叶斯更新。我们将在第4章介绍贝叶斯均衡时简要接触。

**SPNE的假设**\
值得注意的是，SPNE和逆向归纳法依赖于\*\*共同知识的理性（Common Knowledge of Rationality）\*\*假设：每个参与人都是理性的，并且知道其他参与人是理性的，并且知道其他人知道自己是理性的，依此类推，直到博弈的最后一步。

### 本章小结与练习

**小结**：

本章我们从静态博弈迈向了**动态博弈**。我们学习了使用**博弈树（扩展式表述）来精确描述动态博弈的结构，包括行动顺序和信息集**。我们区分了**完美信息**与**不完美信息**博弈。\
关键在于，动态博弈中的**策略**是一个完整的行动计划。我们发现，标准的**纳什均衡**在动态博弈中可能包含**不可信威胁或承诺**。\
为了解决这个问题，我们引入了**子博弈精炼纳什均衡（SPNE）**，它要求策略在博弈的**每一个子博弈**中都构成纳什均衡。\
对于有限期、完美信息的博弈，我们掌握了求解SPNE的强大工具——**逆向归纳法**。通过案例（进入威慑、重复囚徒困境、讨价还价），我们看到了SPNE如何剔除不合理均衡并揭示动态策略互动的逻辑。

**练习**：

1. **控制权转移博弈（Control Rights Game）**：   \
   一家公司的管理层（参与人1）决定是否转让公司控制权。如果不转让，支付分别为(2, 0)；如果转让，接管方（参与人2）可以选择重组或维持现状。如果重组，支付分别为(5, 3)；如果维持现状，支付分别为(3, 1)。   \
   (a) 绘制这个博弈的博弈树。   \
   (b) 找出所有的纳什均衡。   \
   (c) 哪些纳什均衡是子博弈精炼的？
2. **三阶段讨价还价**：   \
   考虑一个三阶段的讨价还价博弈，参与人1和2轮流提议如何分割100元。参与人1首先提议，如果参与人2接受，博弈结束并按提议分配。如果参与人2拒绝，他提出一个新提议，参与人1可以接受或拒绝。如果参与人1拒绝，他再次提议，参与人2做最后的接受或拒绝决定。如果参与人2最终拒绝，双方都得到0。假设每延迟一轮，100元的价值对双方都折扣为原来的 $\delta$ 倍（$0 < \delta < 1$）。   \
   (a) 使用逆向归纳法求解这个博弈的SPNE。   \
   (b) 如果 $\delta = 0.9$，第一阶段参与人1应该提议什么分配方案？
3. **市场进入与承诺（Market Entry with Commitment）**：   \
   修改前面的进入威慑博弈：在参与人1决定是否进入之前，参与人2可以做出一个可信的承诺，表明如果参与人1进入，自己将采取价格战策略。假设做出这样的承诺需要付出成本 $c > 0$。支付矩阵保持不变：如果参与人1不进入，支付为(0, 5)；如果参与人1进入且参与人2接纳，支付为(2, 2)；如果参与人1进入且参与人2发起价格战，支付为(-1, 0)。   \
   (a) 绘制这个修改后博弈的博弈树。   \
   (b) 求解SPNE，并分析不同的 $c$ 值如何影响均衡结果。
4. **信任博弈（Trust Game）**：   \
   参与人1（投资者）决定是否信任并投资于参与人2（受托人）。如果不投资，双方均得到1。如果投资，投资金额翻倍，参与人2决定是归还部分金额还是全部占为己有。如果归还，参与人1得到3，参与人2得到2；如果不归还，参与人1得到0，参与人2得到5。   \
   (a) 绘制这个博弈的博弈树。   \
   (b) 找出所有的纳什均衡和SPNE。   \
   (c) 思考如何修改这个博弈（例如重复多次），使得"投资和归还"成为SPNE？
5.  **【挑战题】链式店铺博弈（Chain-Store Game）**：    \
    一个大型零售商（参与人1）在不同城市开设了两家分店。在每个城市，他面临一个潜在的竞争对手（参与人2和3）依次决定是否进入市场。大型零售商可以对每个进入者采取包容（A）或掠夺性定价（F）的策略。支付如下：

    * 如果竞争者不进入（S），得到0，大型零售商在该城市得到5。
    * 如果竞争者进入（E）且大型零售商包容（A），竞争者得到2，大型零售商在该城市得到2。
    * 如果竞争者进入（E）且大型零售商采取掠夺性定价（F），竞争者得到-1，大型零售商在该城市得到0。

    游戏按以下顺序进行：参与人2（第一个城市的竞争者）决定是否进入；如果进入，参与人1决定对参与人2采取A还是F；然后参与人3（第二个城市的竞争者）决定是否进入；如果进入，参与人1决定对参与人3采取A还是F。

    (a) 绘制这个博弈的博弈树。    \
    (b) 使用逆向归纳法求解SPNE。    \
    (c) 分析为什么这个结果被称为"链式店铺悖论"。考虑如果博弈在更多城市重复，会有什么不同？

    * **(c) 提示：** 应用逆向归纳法，你会发现大型零售商在每个阶段的最优选择都是包容（A）。这似乎与直觉（早期采取掠夺性定价以阻止后期进入者）相悖，故称“悖论”。思考为什么在有限完美信息设定下，声誉效应无法通过逆向归纳法产生。如果博弈是无限重复或存在关于零售商类型的不确定性（不完全信息），结果可能会不同。
